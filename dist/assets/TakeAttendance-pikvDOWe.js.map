{"version":3,"file":"TakeAttendance-pikvDOWe.js","sources":["../../src/components/TakeAttendance.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState, useCallback } from 'react';\nimport { useLocation, useNavigate, useParams } from 'react-router-dom';\nimport { auth, db } from '../firebase';\nimport { collection, collectionGroup, doc, getDoc, getDocs, addDoc, query, where, documentId } from 'firebase/firestore';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faArrowLeft, faClipboardList, faCheckCircle, faClock, faTimesCircle, faUserGraduate, faCalendarAlt, faBookOpen } from '@fortawesome/free-solid-svg-icons';\n\nconst TakeAttendance = () => {\n  const navigate = useNavigate();\n  const { state } = useLocation();\n  const { year, section, semester, courseId } = useParams();\n\n  const [course, setCourse] = useState(state?.course || null);\n  const [students, setStudents] = useState([]);\n  const [attendance, setAttendance] = useState({});\n  const [saving, setSaving] = useState(false);\n  const [selectedDate, setSelectedDate] = useState(() => new Date());\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [facultyCourses, setFacultyCourses] = useState([]);\n  const [coursePreview, setCoursePreview] = useState({}); // { [courseId]: { count, items: [{name, rollNo}] } }\n\n  // Resolve course if not passed via state\n  useEffect(() => {\n    let unsub;\n    const init = async () => {\n      setLoading(true);\n      setError(null);\n      try {\n        await new Promise((resolve) => {\n          unsub = onAuthStateChanged(auth, async (user) => {\n            if (!user) {\n              setError('Not authenticated');\n              setLoading(false);\n              resolve();\n              return;\n            }\n            // If course not present, load from collectionGroup by documentId or list all faculty courses\n            try {\n              if (!course && courseId) {\n                const cg = collectionGroup(db, 'courseDetails');\n                const qs = await getDocs(query(cg, where(documentId(), 'in', [courseId])));\n                qs.forEach((d) => {\n                  const seg = d.ref.path.split('/');\n                  setCourse({ id: d.id, year: seg[1], section: seg[2], semester: seg[3], ...d.data() });\n                });\n              }\n              if (!course && !courseId) {\n                let list = [];\n                try {\n                  const cg = collectionGroup(db, 'courseDetails');\n                  const qs = await getDocs(query(cg, where('instructor', '==', user.uid)));\n                  list = qs.docs.map(d => {\n                    const seg = d.ref.path.split('/');\n                    return { id: d.id, year: seg[1], section: seg[2], semester: seg[3], ...d.data() };\n                  });\n                } catch (_) {\n                  // Fallback without index: enumerate common year/section/semester\n                  const years = ['I','II','III','IV'];\n                  const sections = ['A','B','C','D','E','F'];\n                  const semesters = ['sem1','sem2'];\n                  const tasks = [];\n                  years.forEach((y) => {\n                    sections.forEach((sec) => {\n                      semesters.forEach((sem) => {\n                        tasks.push(getDocs(query(collection(db, 'courses', y, sec, sem, 'courseDetails'), where('instructor', '==', user.uid))));\n                      });\n                    });\n                  });\n                  const results = await Promise.all(tasks);\n                  results.forEach(snap => {\n                    snap.forEach(d => {\n                      const seg = d.ref.path.split('/');\n                      list.push({ id: d.id, year: seg[1], section: seg[2], semester: seg[3], ...d.data() });\n                    });\n                  });\n                }\n                setFacultyCourses(list);\n              }\n            } catch (e) {\n              // non-fatal; user can navigate back\n            }\n            setLoading(false);\n            resolve();\n          });\n        });\n      } catch (e) {\n        setError('Failed to initialize');\n        setLoading(false);\n      }\n    };\n    init();\n    return () => unsub && unsub();\n  }, [course, courseId]);\n\n  // Build course previews (limited student list) when we have facultyCourses\n  useEffect(() => {\n    const buildPreview = async () => {\n      if (!facultyCourses || facultyCourses.length === 0) return;\n      const preview = {};\n      for (const c of facultyCourses) {\n        const ids = Array.isArray(c.students) ? c.students : [];\n        const items = [];\n        let count = ids.length;\n        for (let i = 0; i < Math.min(ids.length, 5); i++) {\n          const sid = ids[i];\n          const tries = [\n            doc(db, `students/${c.year}/${c.section}/${sid}`),\n            doc(db, `students/${sid}`),\n          ];\n          let snap = null;\n          for (const p of tries) {\n            const s = await getDoc(p);\n            if (s.exists()) { snap = s; break; }\n          }\n          if (snap && snap.exists()) {\n            const data = snap.data();\n            items.push({ name: data.name || sid, rollNo: data.rollNo || '' });\n          }\n        }\n        preview[c.id] = { count, items };\n      }\n      setCoursePreview(preview);\n    };\n    buildPreview();\n  }, [facultyCourses]);\n\n  // Load students\n  useEffect(() => {\n    const loadStudents = async () => {\n      if (!course) return;\n      setLoading(true);\n      try {\n        let ids = Array.isArray(course.students) ? course.students : [];\n        if (ids.length === 0) {\n          ids = [];\n        }\n        const list = [];\n        if (ids.length > 0) {\n          for (const sid of ids) {\n            const tries = [\n              doc(db, `students/${course.year}/${course.section}/${sid}`),\n              doc(db, `students/${sid}`),\n            ];\n            let snap = null;\n            for (const p of tries) {\n              const s = await getDoc(p);\n              if (s.exists()) { snap = s; break; }\n            }\n            if (snap && snap.exists()) list.push({ id: snap.id, ...snap.data(), year: course.year, section: course.section });\n          }\n        }\n        setStudents(list);\n        const init = {};\n        list.forEach(s => {\n          init[s.id] = { present: false, late: false, excused: false, absent: true, note: '' };\n        });\n        setAttendance(init);\n      } catch (e) {\n        setError('Failed to load students');\n      } finally {\n        setLoading(false);\n      }\n    };\n    loadStudents();\n  }, [course]);\n\n  const mark = (id, status) => {\n    setAttendance(prev => ({\n      ...prev,\n      [id]: {\n        ...prev[id],\n        present: status === 'present',\n        late: status === 'late',\n        excused: status === 'excused',\n        absent: status === 'absent'\n      }\n    }));\n  };\n\n  const bulk = (status) => {\n    setAttendance(prev => {\n      const next = { ...prev };\n      Object.keys(next).forEach(id => {\n        next[id] = { ...next[id], present: status === 'present', late: status === 'late', excused: status === 'excused', absent: status === 'absent' };\n      });\n      return next;\n    });\n  };\n\n  const totals = useMemo(() => {\n    const vals = Object.values(attendance);\n    const present = vals.filter(v => v.present).length;\n    const late = vals.filter(v => v.late).length;\n    const excused = vals.filter(v => v.excused).length;\n    const absent = vals.filter(v => v.absent).length;\n    return { total: students.length, present, late, excused, absent };\n  }, [attendance, students.length]);\n\n  const save = useCallback(async () => {\n    if (!course) return;\n    setSaving(true);\n    try {\n      await addDoc(collection(db, 'attendance'), {\n        courseId: course.id,\n        courseName: course.courseName || course.id,\n        date: selectedDate.toISOString(),\n        facultyId: auth.currentUser?.uid || '',\n        attendance,\n        totalStudents: totals.total,\n        presentCount: totals.present,\n        lateCount: totals.late,\n        excusedCount: totals.excused,\n        absentCount: totals.absent,\n        createdAt: new Date().toISOString(),\n      });\n      navigate(-1);\n    } catch (e) {\n      setError('Failed to save attendance');\n    } finally {\n      setSaving(false);\n    }\n  }, [course, selectedDate, attendance, totals, navigate]);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 p-8\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"mb-12 animate-fade-in\">\n            <div className=\"h-16 bg-gray-200 rounded-2xl mb-6 animate-pulse\"></div>\n            <div className=\"h-8 bg-gray-200 rounded-xl w-1/3 animate-pulse\"></div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 flex items-center justify-center p-8\">\n        <div className=\"bg-white rounded-2xl shadow-xl p-12 text-center border border-gray-100\">\n          <div className=\"text-blue-600 text-xl font-semibold\">{error}</div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-6\">\n      <div className=\"page-container\">\n        <div className=\"mb-6 flex items-center gap-3\">\n          <h1 className=\"text-2xl font-semibold text-gray-900\">Take Attendance</h1>\n          <p className=\"text-xs text-gray-500\">\n            {course ? `${course?.courseName || courseId} • ${course?.year}-${course?.section} • ${course?.semester?.toUpperCase?.() || course?.semester}` : 'Select a course to begin'}\n          </p>\n        </div>\n\n        {!course && (\n          facultyCourses.length === 0 ? (\n            <div className=\"text-center text-gray-700 bg-white rounded-2xl shadow-xl p-12 border border-gray-100\">No courses found for your account.</div>\n          ) : (\n            <section className=\"grid gap-4 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3\">\n              {facultyCourses.map((c, i) => (\n                <div key={c.id} className=\"group bg-white rounded-lg border p-4 hover:shadow-sm animate-fade-in\" style={{ animationDelay: `${i * 100}ms` }}>\n                  <div className=\"flex items-start justify-between mb-3\">\n                    <div className=\"w-10 h-10 bg-blue-50 text-blue-600 rounded-md flex items-center justify-center\">\n                      <FontAwesomeIcon icon={faBookOpen} className=\"text-sm\" />\n                    </div>\n                  </div>\n                  <h3 className=\"text-base font-semibold text-gray-900 mb-1\">{c.courseName || c.id}</h3>\n                  <p className=\"text-sm text-gray-600 mb-2\">{c.year}-{c.section} • {c.semester?.toUpperCase?.() || c.semester}</p>\n                  <div className=\"text-xs text-gray-600 mb-3\">\n                    Enrolled Students: {coursePreview[c.id]?.count ?? 0}\n                    {coursePreview[c.id]?.items?.length > 0 && (\n                      <ul className=\"mt-2 space-y-1\">\n                        {coursePreview[c.id].items.map((it, idx) => (\n                          <li key={idx} className=\"text-gray-700\">• {it.name}{it.rollNo ? ` (${it.rollNo})` : ''}</li>\n                        ))}\n                      </ul>\n                    )}\n                  </div>\n                  <button onClick={() => setCourse(c)} className=\"btn-campus-primary px-3 py-2 rounded-md text-sm\">Start</button>\n                </div>\n              ))}\n            </section>\n          )\n        )}\n\n        {course && (\n          <section className=\"compact-card\">\n            <div className=\"flex flex-wrap items-center gap-3 mb-6\">\n              <span className=\"text-xs text-gray-600\">Mark all as:</span>\n              <button onClick={() => bulk('present')} className=\"px-2.5 py-1 rounded-full bg-green-100 text-green-700 text-xs font-medium hover:bg-green-200\">Present</button>\n              <button onClick={() => bulk('late')} className=\"px-2.5 py-1 rounded-full bg-yellow-100 text-yellow-700 text-xs font-medium hover:bg-yellow-200\">Late</button>\n              <button onClick={() => bulk('excused')} className=\"px-2.5 py-1 rounded-full bg-blue-100 text-blue-700 text-xs font-medium hover:bg-blue-200\">Excused</button>\n              <button onClick={() => bulk('absent')} className=\"px-2.5 py-1 rounded-full bg-red-100 text-red-700 text-xs font-medium hover:bg-red-200\">Absent</button>\n            </div>\n\n            <div className=\"grid grid-cols-1 gap-4\">\n              {students.map((s) => (\n                <div key={s.id} className=\"bg-gray-50 border border-gray-200 rounded-md p-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-8 h-8 bg-blue-50 text-blue-600 rounded-md flex items-center justify-center\">\n                        <FontAwesomeIcon icon={faUserGraduate} className=\"text-xs\" />\n                      </div>\n                      <div>\n                        <div className=\"text-sm font-semibold text-gray-900\">{s.name || s.id}</div>\n                        <div className=\"text-xs text-gray-600\">{s.rollNo || s.email}</div>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <button onClick={() => mark(s.id, 'present')} className={`px-2.5 py-1 rounded-full text-xs font-medium ${attendance[s.id]?.present ? 'bg-green-500 text-white' : 'bg-gray-100 text-gray-600 hover:bg-green-100'}`}><FontAwesomeIcon icon={faCheckCircle} className=\"mr-1\"/>Present</button>\n                      <button onClick={() => mark(s.id, 'late')} className={`px-2.5 py-1 rounded-full text-xs font-medium ${attendance[s.id]?.late ? 'bg-yellow-500 text-white' : 'bg-gray-100 text-gray-600 hover:bg-yellow-100'}`}><FontAwesomeIcon icon={faClock} className=\"mr-1\"/>Late</button>\n                      <button onClick={() => mark(s.id, 'excused')} className={`px-2.5 py-1 rounded-full text-xs font-medium ${attendance[s.id]?.excused ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-600 hover:bg-blue-100'}`}>Excused</button>\n                      <button onClick={() => mark(s.id, 'absent')} className={`px-2.5 py-1 rounded-full text-xs font-medium ${attendance[s.id]?.absent ? 'bg-red-500 text-white' : 'bg-gray-100 text-gray-600 hover:bg-red-100'}`}><FontAwesomeIcon icon={faTimesCircle} className=\"mr-1\"/>Absent</button>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            <div className=\"mt-6 flex justify-end\">\n              <button onClick={save} disabled={saving} className=\"btn-campus-primary px-4 py-2 rounded-md text-sm disabled:opacity-50\">\n                {saving ? 'Saving...' : 'Save Attendance'}\n              </button>\n            </div>\n          </section>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default TakeAttendance;\n"],"names":["TakeAttendance","navigate","useNavigate","state","useLocation","year","section","semester","courseId","useParams","course","setCourse","useState","students","setStudents","attendance","setAttendance","saving","setSaving","selectedDate","setSelectedDate","loading","setLoading","error","setError","facultyCourses","setFacultyCourses","coursePreview","setCoursePreview","useEffect","unsub","resolve","onAuthStateChanged","auth","user","cg","collectionGroup","db","getDocs","query","where","documentId","d","seg","list","years","sections","semesters","tasks","y","sec","sem","collection","snap","preview","c","ids","items","count","i","sid","tries","doc","p","s","getDoc","data","init","mark","id","status","prev","bulk","next","totals","useMemo","vals","present","v","late","excused","absent","save","useCallback","addDoc","jsx","jsxs","FontAwesomeIcon","faBookOpen","it","idx","faUserGraduate","faCheckCircle","faClock","faTimesCircle"],"mappings":"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"}