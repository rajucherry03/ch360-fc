const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C7a0D0cT.js","assets/query-_HUGc1jU.js","assets/router-CGnu6c2M.js","assets/vendor-Dazix4UH.js","assets/ui-ZG8wUPwK.js","assets/firebase-CGo28arV.js","assets/index-CHLvfzWk.css"])))=>i.map(i=>d[i]);
import{_ as E,d as j}from"./index-C7a0D0cT.js";import{j as e}from"./query-_HUGc1jU.js";import{g as G,u as L,r as p}from"./router-CGnu6c2M.js";import{h as N,j as b,q as R,w as V,l as Y}from"./firebase-CGo28arV.js";import{F as d,a1 as q,s as M,v as J,B as Q,h as $,o as I,r as U,x as z,c as H,y as W,g as X,p as Z}from"./ui-ZG8wUPwK.js";import"./vendor-Dazix4UH.js";const ne=()=>{const{year:i,section:g,semester:m,courseId:t}=G(),y=L(),[s,k]=p.useState(null),[f,S]=p.useState([]),[A,C]=p.useState(!0),[v,w]=p.useState(null),[B,P]=p.useState(null);return p.useEffect(()=>{(async()=>{try{C(!0),w(null),console.log("ðŸ” Fetching course details for:",{year:i,section:g,semester:m,courseId:t});let x=null;try{const{auth:c}=await E(async()=>{const{auth:l}=await import("./index-C7a0D0cT.js").then(o=>o.f);return{auth:l}},__vite__mapDeps([0,1,2,3,4,5,6])),{onAuthStateChanged:n}=await E(async()=>{const{onAuthStateChanged:l}=await import("./firebase-CGo28arV.js").then(o=>o.J);return{onAuthStateChanged:l}},[]);n(c,async l=>{if(l){const o=N(j,"faculty","CSE_DS","members",l.uid),a=await b(o);a.exists()&&(x=a.data(),P(x),console.log("âœ… Faculty data fetched:",x.name))}})}catch(c){console.log("âŒ Could not fetch faculty data:",c)}let r=null;r=await(async()=>{console.log("ðŸš€ Dynamic course fetch starting...");try{const n=N(j,"courses","CSE_DS","year_sem",`${i}_${m}`,"courseDetails",t),l=await b(n);if(l.exists())return r=l.data(),console.log("âœ… Course found via exact path"),r}catch{console.log("âŒ Exact path failed, trying alternatives...")}try{const n=collectionGroup(j,"courseDetails"),l=R(n,V("__name__","==",t)),o=await Y(l);if(!o.empty)return r=o.docs[0].data(),console.log("âœ… Course found via collectionGroup"),r}catch{console.log("âŒ CollectionGroup failed, trying path variations...")}const c=[["courses","CSE_DS","year_sem",`${i}_${m}`,"courseDetails",t],["courses","CSE_DS","year_sem","III_5","courseDetails",t],["courses","CSE_DS","year_sem","III_6","courseDetails",t],["courses","CSE_DS","year_sem","III_7","courseDetails",t],["courses","CSE_DS","year_sem","III_8","courseDetails",t],["courses",i,g,m,"courseDetails",t],["courses","III","A","5","courseDetails",t],["courses","III","B","5","courseDetails",t],["courses","III","C","5","courseDetails",t],["courses",t],["courseDetails",t],["courses","CSE","year_sem",`${i}_${m}`,"courseDetails",t],["courses","CSEDS","year_sem",`${i}_${m}`,"courseDetails",t]];for(const n of c)try{const l=N(j,...n),o=await b(l);if(o.exists())return r=o.data(),console.log("âœ… Course found via path variation:",n.join("/")),r}catch{}return console.log("âŒ No course found in any path variation"),null})(),r||(console.log("âš ï¸ No course data found, creating fallback data"),r={courseName:`Course ${t}`,courseCode:t,description:`Course ${t} - ${x?.name||"Faculty"}`,displayYear:i||"III",displaySection:g||"A",displaySemester:m||"5",displayDepartment:"Computer Science & Engineering (Data Science)",credits:3,studentsBySection:{},students:[]});const F=async c=>{if(!c)return[];console.log("ðŸ“š Dynamic student fetch starting...");const n=[];c.studentsBySection&&typeof c.studentsBySection=="object"&&(console.log("ðŸ“š Found studentsBySection structure"),Object.keys(c.studentsBySection).forEach(a=>{Array.isArray(c.studentsBySection[a])&&c.studentsBySection[a].forEach(h=>{n.push({id:h,section:a})})})),c.students&&Array.isArray(c.students)&&(console.log("ðŸ“š Found students array structure"),c.students.forEach(a=>{n.push({id:a,section:"A"})})),c.enrolledStudents&&Array.isArray(c.enrolledStudents)&&(console.log("ðŸ“š Found enrolledStudents array structure"),c.enrolledStudents.forEach(a=>{n.push({id:a,section:"A"})})),console.log("ðŸ“š Total student IDs found:",n.length);const l=n.map(async({id:a,section:h})=>{const T=[["students","CSEDS",`${i}-${h}`,a],["students","CSE_DS",`${i}_${h}`,a],["students","CSEDS","III-A",a],["students","CSE_DS","III_A",a],["students","CSE","III-A",a],["students","CSEDS","III-B",a],["students","CSE_DS","III_B",a],["students","CSEDS","III-C",a],["students","CSE_DS","III_C",a],["students",a],["studentDetails",a],["students","CSE",`${i}-${h}`,a],["students","CSEDS",`${i}_${h}`,a]];for(const O of T)try{const D=N(j,...O),_=await b(D);if(_.exists())return{id:a,section:h,..._.data()}}catch{}return{id:a,name:`Student ${a}`,rollNo:a,section:h}}),o=await Promise.all(l);return console.log("âœ… Students fetched dynamically:",o.length),o};if(r){const c=await F(r);S(c)}else console.log("âš ï¸ No course data available for student fetch"),S([]);k({id:t,year:r?.displayYear||i||"III",section:r?.displaySection||g||"A",semester:r?.displaySemester||m||"5",courseName:r?.courseName||`Course ${t}`,courseCode:r?.courseCode||t,description:r?.description||`Course ${t} - ${x?.name||"Faculty"}`,instructor:r?.instructor,instructorName:x?.name||r?.instructor||"Faculty Member",credits:r?.credits||3,department:r?.displayDepartment||"Computer Science & Engineering (Data Science)",studentsBySection:r?.studentsBySection||{},masterCoursePath:r?.masterCoursePath,semesterKey:r?.semesterKey||`${i}_${m}`,students:r?.students||[]}),S([])}catch(x){console.error("âŒ Error:",x),console.log("ðŸ” Debug info:",{year:i,section:g,semester:m,courseId:t,foundCourseData}),w(`Error fetching course details: ${x.message}`)}finally{C(!1)}})()},[i,g,m,t]),A?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(d,{icon:q,className:"text-blue-600 text-4xl animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading course details..."})]})}):v?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center max-w-md",children:[e.jsx(d,{icon:M,className:"text-red-500 text-4xl mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error"}),e.jsx("p",{className:"text-gray-600 mb-4",children:v}),e.jsx("button",{onClick:()=>y("/courses"),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Back to Courses"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"page-container",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>y("/courses"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",children:[e.jsx(d,{icon:J}),"Back to Courses"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.courseName||s.courseCode||`Course ${t}`}),e.jsxs("p",{className:"text-gray-600 text-sm",children:[s.year,"-",s.section," â€¢ Semester ",s.semester]})]})]})}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(d,{icon:Q,className:"text-blue-600"}),"Course Overview"]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Course Name"}),e.jsx("p",{className:"text-gray-900 font-medium",children:s.courseName||s.courseCode||`Course ${t}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Course Code"}),e.jsx("p",{className:"text-gray-900 font-medium",children:s.courseCode||s.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsx("p",{className:"text-gray-900 font-medium",children:s.department||"Computer Science & Engineering"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credits"}),e.jsx("p",{className:"text-gray-900",children:s.credits||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instructor"}),e.jsx("p",{className:"text-gray-900",children:s.instructorName||s.instructor||"Not assigned"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-900",children:s.description||s.courseDescription||`Course ${t} - ${B?.name||"Faculty"}`})]})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(d,{icon:$,className:"text-green-600"}),"Course Details"]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),e.jsx("p",{className:"text-gray-900",children:s.year})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),e.jsx("p",{className:"text-gray-900",children:s.section})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Semester"}),e.jsx("p",{className:"text-gray-900",children:s.semester})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsx("p",{className:"text-gray-900",children:s.department||"Computer Science & Engineering"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Semester Key"}),e.jsx("p",{className:"text-gray-900",children:s.semesterKey||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Students"}),e.jsx("p",{className:"text-gray-900",children:f.length})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Course Path"}),e.jsx("p",{className:"text-gray-900 text-sm font-mono bg-gray-100 p-2 rounded",children:s.masterCoursePath||`/courses/CSE_DS/year_sem/${s.semesterKey}/courseDetails/${t}/sections/${s.section}`})]})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(d,{icon:I,className:"text-purple-600"}),"Enrolled Students (",f.length,")"]}),f.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Roll No"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Section"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map((u,x)=>e.jsxs("tr",{className:x%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:u.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:u.name||u.studentName||`Student ${u.id}`}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:u.rollNo||u.rollNumber||u.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:u.section||"A"})]},u.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(d,{icon:I,className:"text-gray-400 text-4xl mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No students enrolled in this course yet."})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Course Statistics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Students"}),e.jsx("span",{className:"font-semibold text-gray-900",children:f.length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Sections"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.studentsBySection?Object.keys(s.studentsBySection).length:0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Credits"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.credits||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Year"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.year})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Section"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.section})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Semester"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.semester})]})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>y(`/attendance/${s.year}/${s.section}/${s.semester}/${s.id}`),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[e.jsx(d,{icon:U}),"Mark Attendance"]}),e.jsxs("button",{onClick:()=>y(`/grades/${s.year}/${s.section}/${s.semester}/${s.id}`),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[e.jsx(d,{icon:z}),"Manage Grades"]}),e.jsxs("button",{onClick:()=>y(`/exam/${s.year}/${s.section}/${s.semester}/${s.id}`),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:[e.jsx(d,{icon:$}),"Create Exam"]})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Course Information"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:H,className:"text-blue-600 w-4"}),e.jsx("span",{className:"text-gray-600",children:"Instructor:"}),e.jsx("span",{className:"font-medium",children:s.instructorName||s.instructor||"Not assigned"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:W,className:"text-green-600 w-4"}),e.jsx("span",{className:"text-gray-600",children:"Department:"}),e.jsx("span",{className:"font-medium",children:s.department||"CSE"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:X,className:"text-purple-600 w-4"}),e.jsx("span",{className:"text-gray-600",children:"Semester:"}),e.jsx("span",{className:"font-medium",children:s.semester})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:Z,className:"text-orange-600 w-4"}),e.jsx("span",{className:"text-gray-600",children:"Credits:"}),e.jsx("span",{className:"font-medium",children:s.credits||"N/A"})]})]})]})]})]})]})})};export{ne as default};
//# sourceMappingURL=CourseDetails-C_Fx7e2j.js.map
