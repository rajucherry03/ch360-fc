const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DAak1JJl.js","assets/query-_HUGc1jU.js","assets/router-CGnu6c2M.js","assets/vendor-Dazix4UH.js","assets/ui-BE1NG-gw.js","assets/firebase-CGo28arV.js","assets/index-B7y-bClP.css"])))=>i.map(i=>d[i]);
import{_ as D,d as y}from"./index-DAak1JJl.js";import{j as e}from"./query-_HUGc1jU.js";import{g as L,u as G,r as f}from"./router-CGnu6c2M.js";import{h as p,j as b,q as T,w as M,l as O}from"./firebase-CGo28arV.js";import{F as l,a0 as R,v as q,t as V,i as U,p as Y,x as E,q as J,C as W,h as z}from"./ui-BE1NG-gw.js";import"./vendor-Dazix4UH.js";const re=()=>{const{year:i,section:h,semester:m,courseId:t}=L(),w=G(),[o,I]=f.useState(null),[j,g]=f.useState([]),[$,N]=f.useState(!0),[v,S]=f.useState(null),[A,k]=f.useState(null);return f.useEffect(()=>{(async()=>{try{N(!0),S(null),console.log("ðŸ” Fetching course details for:",{year:i,section:h,semester:m,courseId:t});let x=null;try{const{auth:a}=await D(async()=>{const{auth:n}=await import("./index-DAak1JJl.js").then(d=>d.f);return{auth:n}},__vite__mapDeps([0,1,2,3,4,5,6])),{onAuthStateChanged:c}=await D(async()=>{const{onAuthStateChanged:n}=await import("./firebase-CGo28arV.js").then(d=>d.J);return{onAuthStateChanged:n}},[]);c(a,async n=>{if(n){const d=p(y,"faculty","CSE_DS","members",n.uid),s=await b(d);s.exists()&&(x=s.data(),k(x),console.log("âœ… Faculty data fetched:",x.name))}})}catch(a){console.log("âŒ Could not fetch faculty data:",a)}let r=null;r=await(async()=>{console.log("ðŸš€ Dynamic course fetch starting...");try{const c=p(y,"courses","CSE_DS","year_sem",`${i}_${m}`,"courseDetails",t),n=await b(c);if(n.exists())return r=n.data(),console.log("âœ… Course found via exact path"),r}catch{console.log("âŒ Exact path failed, trying alternatives...")}try{const c=collectionGroup(y,"courseDetails"),n=T(c,M("__name__","==",t)),d=await O(n);if(!d.empty)return r=d.docs[0].data(),console.log("âœ… Course found via collectionGroup"),r}catch{console.log("âŒ CollectionGroup failed, trying path variations...")}const a=[["courses","CSE_DS","year_sem",`${i}_${m}`,"courseDetails",t],["courses","CSE_DS","year_sem","III_5","courseDetails",t],["courses","CSE_DS","year_sem","III_6","courseDetails",t],["courses","CSE_DS","year_sem","III_7","courseDetails",t],["courses","CSE_DS","year_sem","III_8","courseDetails",t],["courses",i,h,m,"courseDetails",t],["courses","III","A","5","courseDetails",t],["courses","III","B","5","courseDetails",t],["courses","III","C","5","courseDetails",t],["courses",t],["courseDetails",t],["courses","CSE","year_sem",`${i}_${m}`,"courseDetails",t],["courses","CSEDS","year_sem",`${i}_${m}`,"courseDetails",t]];for(const c of a)try{const n=p(y,...c),d=await b(n);if(d.exists())return r=d.data(),console.log("âœ… Course found via path variation:",c.join("/")),r}catch{}return console.log("âŒ No course found in any path variation"),null})(),r||(console.log("âš ï¸ No course data found, creating fallback data"),r={courseName:`Course ${t}`,courseCode:t,description:`Course ${t} - ${x?.name||"Faculty"}`,displayYear:i||"III",displaySection:h||"A",displaySemester:m||"5",displayDepartment:"Computer Science & Engineering (Data Science)",credits:3,studentsBySection:{},students:[]});const B=async a=>{if(!a)return[];console.log("ðŸ“š Dynamic student fetch starting...");const c=[];a.studentsBySection&&typeof a.studentsBySection=="object"&&(console.log("ðŸ“š Found studentsBySection structure"),Object.keys(a.studentsBySection).forEach(s=>{Array.isArray(a.studentsBySection[s])&&a.studentsBySection[s].forEach(u=>{c.push({id:u,section:s})})})),a.students&&Array.isArray(a.students)&&(console.log("ðŸ“š Found students array structure"),a.students.forEach(s=>{c.push({id:s,section:"A"})})),a.enrolledStudents&&Array.isArray(a.enrolledStudents)&&(console.log("ðŸ“š Found enrolledStudents array structure"),a.enrolledStudents.forEach(s=>{c.push({id:s,section:"A"})})),console.log("ðŸ“š Total student IDs found:",c.length);const n=c.map(async({id:s,section:u})=>{const F=[["students","CSEDS",`${i}-${u}`,s],["students","CSE_DS",`${i}_${u}`,s],["students","CSEDS","III-A",s],["students","CSE_DS","III_A",s],["students","CSE","III-A",s],["students","CSEDS","III-B",s],["students","CSE_DS","III_B",s],["students","CSEDS","III-C",s],["students","CSE_DS","III_C",s],["students",s],["studentDetails",s],["students","CSE",`${i}-${u}`,s],["students","CSEDS",`${i}_${u}`,s]];for(const P of F)try{const C=p(y,...P),_=await b(C);if(_.exists())return{id:s,section:u,..._.data()}}catch{}return{id:s,name:`Student ${s}`,rollNo:s,section:u}}),d=await Promise.all(n);return console.log("âœ… Students fetched dynamically:",d.length),d};if(r){const a=await B(r);g(a)}else console.log("âš ï¸ No course data available for student fetch"),g([]);I({id:t,year:r?.displayYear||i||"III",section:r?.displaySection||h||"A",semester:r?.displaySemester||m||"5",courseName:r?.courseName||`Course ${t}`,courseCode:r?.courseCode||t,description:r?.description||`Course ${t} - ${x?.name||"Faculty"}`,instructor:r?.instructor,instructorName:x?.name||r?.instructor||"Faculty Member",credits:r?.credits||3,department:r?.displayDepartment||"Computer Science & Engineering (Data Science)",studentsBySection:r?.studentsBySection||{},masterCoursePath:r?.masterCoursePath,semesterKey:r?.semesterKey||`${i}_${m}`,students:r?.students||[]}),g([])}catch(x){console.error("âŒ Error:",x),console.log("ðŸ” Debug info:",{year:i,section:h,semester:m,courseId:t,foundCourseData}),S(`Error fetching course details: ${x.message}`)}finally{N(!1)}})()},[i,h,m,t]),$?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(l,{icon:R,className:"text-blue-600 text-4xl animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading course details..."})]})}):v?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(l,{icon:q,className:"text-accent text-4xl mb-4"}),e.jsx("div",{className:"text-primary text-xl font-semibold",children:v})]})}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-surface border-b border-border-theme",children:e.jsx("div",{className:"max-w-6xl mx-auto px-6 py-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-8 h-8 bg-accent/10 text-accent rounded-md flex items-center justify-center",children:e.jsx(l,{icon:V,className:"text-sm"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-primary",children:"Course Details"}),e.jsxs("p",{className:"text-secondary text-xs",children:["Welcome back, ",A?.name||"Faculty"]})]})]}),e.jsxs("button",{onClick:()=>w("/logout"),className:"btn-primary inline-flex items-center gap-2 px-3 py-2 text-sm",children:[e.jsx(l,{icon:faSignOutAlt}),"Logout"]})]})})}),e.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[e.jsxs("div",{className:"bg-surface border border-border-theme rounded-md p-6 mb-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-8 h-8 bg-accent/10 text-accent rounded-md flex items-center justify-center",children:e.jsx(l,{icon:U,className:"text-sm"})}),e.jsx("h2",{className:"text-lg font-semibold text-primary",children:"Course Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Course Name"}),e.jsx("p",{className:"text-primary",children:o?.courseName||"Loading..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Course Code"}),e.jsx("p",{className:"text-primary",children:o?.courseCode||"Loading..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Credits"}),e.jsxs("p",{className:"text-primary",children:[o?.credits||"Loading..."," credits"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Description"}),e.jsx("p",{className:"text-primary",children:o?.description||"No description available"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Instructor"}),e.jsx("p",{className:"text-primary",children:o?.instructorName||o?.instructor||"Loading..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Semester"}),e.jsx("p",{className:"text-primary",children:o?.semester||"Loading..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Enrolled Students"}),e.jsxs("p",{className:"text-primary",children:[j.length||0," students"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Status"}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-secondary/10 text-secondary",children:"Active"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs(Link,{to:`/attendance/${o.year}/${o.section}/${o.semester}/${o.id}`,className:"bg-surface border border-border-theme rounded-md p-6 hover:shadow transition cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-secondary rounded-full flex items-center justify-center",children:e.jsx(l,{icon:Y,className:"text-white text-sm"})}),e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Take Attendance"})]}),e.jsx("p",{className:"text-secondary mb-4",children:"Mark attendance for students enrolled in this course."}),e.jsxs("div",{className:"inline-flex items-center gap-2 w-full justify-center px-4 py-2 bg-secondary text-white rounded-md hover:bg-secondary/90",children:[e.jsx(l,{icon:faClipboardCheck}),"Take Attendance"]})]}),e.jsxs(Link,{to:`/grades/${o.year}/${o.section}/${o.semester}/${o.id}`,className:"bg-surface border border-border-theme rounded-md p-6 hover:shadow transition cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center",children:e.jsx(l,{icon:E,className:"text-white text-sm"})}),e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Manage Grades"})]}),e.jsx("p",{className:"text-secondary mb-4",children:"Update and manage student grades for this course."}),e.jsxs("div",{className:"inline-flex items-center gap-2 w-full justify-center px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90",children:[e.jsx(l,{icon:faEdit}),"Manage Grades"]})]})]}),e.jsxs("div",{className:"bg-surface border border-border-theme rounded-md p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-8 h-8 bg-accent/10 text-accent rounded-md flex items-center justify-center",children:e.jsx(l,{icon:faChartBar,className:"text-sm"})}),e.jsx("h2",{className:"text-lg font-semibold text-primary",children:"Course Statistics"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-background rounded-md p-4 text-center border border-border-theme",children:[e.jsx("div",{className:"text-2xl font-bold text-accent",children:j.length||0}),e.jsx("div",{className:"text-sm text-secondary",children:"Enrolled Students"})]}),e.jsxs("div",{className:"bg-background rounded-md p-4 text-center border border-border-theme",children:[e.jsx("div",{className:"text-2xl font-bold text-secondary",children:"85%"}),e.jsx("div",{className:"text-sm text-secondary",children:"Average Attendance"})]}),e.jsxs("div",{className:"bg-background rounded-md p-4 text-center border border-border-theme",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:"78%"}),e.jsx("div",{className:"text-sm text-secondary",children:"Average Grade"})]}),e.jsxs("div",{className:"bg-background rounded-md p-4 text-center border border-border-theme",children:[e.jsx("div",{className:"text-2xl font-bold text-accent",children:"12"}),e.jsx("div",{className:"text-sm text-secondary",children:"Assignments"})]})]})]}),e.jsxs("div",{className:"bg-surface border border-border-theme rounded-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-8 h-8 bg-accent/10 text-accent rounded-md flex items-center justify-center",children:e.jsx(l,{icon:J,className:"text-sm"})}),e.jsx("h2",{className:"text-lg font-semibold text-primary",children:"Recent Activity"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-background rounded-md border border-border-theme",children:[e.jsx("div",{className:"w-8 h-8 bg-secondary rounded-full flex items-center justify-center",children:e.jsx(l,{icon:W,className:"text-white text-xs"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-primary text-sm",children:"Attendance marked for today"}),e.jsx("p",{className:"text-xs text-secondary",children:"32 students present, 3 absent"})]}),e.jsx("div",{className:"text-xs text-secondary",children:"2 hours ago"})]}),e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-background rounded-md border border-border-theme",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center",children:e.jsx(l,{icon:z,className:"text-white text-xs"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-primary text-sm",children:"Assignment deadline updated"}),e.jsx("p",{className:"text-xs text-secondary",children:"Project submission due next week"})]}),e.jsx("div",{className:"text-xs text-secondary",children:"1 day ago"})]}),e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-background rounded-md border border-border-theme",children:[e.jsx("div",{className:"w-8 h-8 bg-accent rounded-full flex items-center justify-center",children:e.jsx(l,{icon:E,className:"text-white text-xs"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-primary text-sm",children:"Grades updated"}),e.jsx("p",{className:"text-xs text-secondary",children:"Mid-term exam grades posted"})]}),e.jsx("div",{className:"text-xs text-secondary",children:"3 days ago"})]})]})]})]})]})};export{re as default};
//# sourceMappingURL=CourseDetails-CIEnkWWl.js.map
